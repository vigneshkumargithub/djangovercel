from django.template import Library, Node, TemplateSyntaxError
from django.utils import formats

register = Library()


@register.filter(is_safe=False)
def localize(value):
    """
<<<<<<< HEAD
    Force a value to be rendered as a localized value,
    regardless of the value of ``settings.USE_L10N``.
=======
    Force a value to be rendered as a localized value.
>>>>>>> 32e7214c1350fb4a88064960159c92207483e581
    """
    return str(formats.localize(value, use_l10n=True))


@register.filter(is_safe=False)
def unlocalize(value):
    """
<<<<<<< HEAD
    Force a value to be rendered as a non-localized value,
    regardless of the value of ``settings.USE_L10N``.
=======
    Force a value to be rendered as a non-localized value.
>>>>>>> 32e7214c1350fb4a88064960159c92207483e581
    """
    return str(formats.localize(value, use_l10n=False))


class LocalizeNode(Node):
    def __init__(self, nodelist, use_l10n):
        self.nodelist = nodelist
        self.use_l10n = use_l10n

    def __repr__(self):
<<<<<<< HEAD
        return '<%s>' % self.__class__.__name__
=======
        return "<%s>" % self.__class__.__name__
>>>>>>> 32e7214c1350fb4a88064960159c92207483e581

    def render(self, context):
        old_setting = context.use_l10n
        context.use_l10n = self.use_l10n
        output = self.nodelist.render(context)
        context.use_l10n = old_setting
        return output


<<<<<<< HEAD
@register.tag('localize')
def localize_tag(parser, token):
    """
    Force or prevents localization of values, regardless of the value of
    `settings.USE_L10N`.
=======
@register.tag("localize")
def localize_tag(parser, token):
    """
    Force or prevents localization of values.
>>>>>>> 32e7214c1350fb4a88064960159c92207483e581

    Sample usage::

        {% localize off %}
            var pi = {{ 3.1415 }};
        {% endlocalize %}
    """
    use_l10n = None
    bits = list(token.split_contents())
    if len(bits) == 1:
        use_l10n = True
<<<<<<< HEAD
    elif len(bits) > 2 or bits[1] not in ('on', 'off'):
        raise TemplateSyntaxError("%r argument should be 'on' or 'off'" % bits[0])
    else:
        use_l10n = bits[1] == 'on'
    nodelist = parser.parse(('endlocalize',))
=======
    elif len(bits) > 2 or bits[1] not in ("on", "off"):
        raise TemplateSyntaxError("%r argument should be 'on' or 'off'" % bits[0])
    else:
        use_l10n = bits[1] == "on"
    nodelist = parser.parse(("endlocalize",))
>>>>>>> 32e7214c1350fb4a88064960159c92207483e581
    parser.delete_first_token()
    return LocalizeNode(nodelist, use_l10n)
